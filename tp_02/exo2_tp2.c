#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>
#include <time.h>

#define MAX_ELEMENTS 100

// Structure TypeTableau
typedef struct {
    int tableau[MAX_ELEMENTS];
    int nombreElements;
    int x;
} TypeTableau;

// Fonction exécutée par le thread pour initialiser le tableau
void *initialiserTableau(void *data) {
    TypeTableau *tdata = (TypeTableau *)data;
    int nombreElements = tdata->nombreElements;

    srand(time(NULL)); // Initialiser la graine du générateur aléatoire

    for (int i = 0; i < nombreElements; i++) {
        tdata->tableau[i] = rand() % 100; // Valeurs aléatoires entre 0 et 99
    }

    pthread_exit(NULL);
}

// Fonction exécutée par le thread pour vérifier la présence de x dans le tableau
void *verifierPresence(void *data) {
    TypeTableau *tdata = (TypeTableau *)data;
    int x = tdata->x;
    int nombreElements = tdata->nombreElements;

    for (int i = 0; i < nombreElements; i++) {
        if (tdata->tableau[i] == x) {
            pthread_exit((void *)1); // x est présent
        }
    }

    pthread_exit((void *)0); // x n'est pas présent
}

int main() {
    TypeTableau data;
    int nombreElements;

    // Demander à l'utilisateur de saisir le nombre d'éléments du tableau
    printf("Entrez le nombre d'éléments du tableau : ");
    scanf("%d", &nombreElements);

    if (nombreElements > MAX_ELEMENTS) {
        printf("Nombre d'éléments trop grand. Limite : %d\n", MAX_ELEMENTS);
        return 1;
    }

    data.nombreElements = nombreElements;

    // Demander à l'utilisateur de saisir l'entier x
    printf("Entrez un entier x : ");
    scanf("%d", &data.x);

    pthread_t thread1, thread2;
    int presence;

    pthread_create(&thread1, NULL, initialiserTableau, &data);
    pthread_create(&thread2, NULL, verifierPresence, &data);

    pthread_join(thread1, NULL);
    pthread_join(thread2, (void **)&presence);

    if (presence == 1) {
        printf("L'élément %d est présent dans le tableau.\n", data.x);
    } else {
        printf("L'élément %d n'est pas présent dans le tableau.\n", data.x);
    }

    return 0;
}
