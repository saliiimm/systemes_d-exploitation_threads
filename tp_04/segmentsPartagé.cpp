#include<iostream>
#include<sys/ipc.h>
#include<sys/types.h>
#include<sys/shm.h>
#include<sys/stat.h>
#include<string.h>
#include<unistd.h> 
using namespace std ;
const int seg_size = 0x6400 ;
int main() {
char* shared_memory;
struct shmid_ds shmbuffer; int segment_size;
int id = shmget(IPC_PRIVATE, seg_size, IPC_CREAT | IPC_EXCL | S_IRUSR | S_IWUSR);

 shared_memory = (char*) shmat (id, 0, 0);
cout << "mémoire partagée attachée à l'adresse " << (int*)shared_memory << endl;

shmctl (id, IPC_STAT, &shmbuffer);
segment_size = shmbuffer.shm_segsz; 
cout << "taille du segment : "<< segment_size << endl; 

string temp = "Hello world. " ;
 strcpy(shared_memory, temp.c_str());

shmdt (shared_memory);

shared_memory = (char*) shmat (id, (const void *)0x5000000, 0);
 cout << "Mémoire partagée attachée à l'adresse " << (int *)shared_memory << endl;

cout << "Chaine de sortie : "<< shared_memory << endl;

 shmdt (shared_memory); shmctl(id, IPC_RMID, 0);
 
  return 0;
}